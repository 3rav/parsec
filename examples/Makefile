CC=mpicc
CFLAGS=-Wall `pkg-config --cflags parsec` -g3
LDFLAGS=`pkg-config --libs parsec` -pthread -lm -lrt -ldl -lcudart

DAGUEPP=daguepp
DAGUEPPFLAGS=

EXAMPLES= Ex01_HelloWorld

# Keep intermediate .c/.h files generated by daguepp
EXAMPLES_C=${EXAMPLES_C=:.c}
EXAMPLES_H=${EXAMPLES_H=:.h}

.SECONDARY: ${EXAMPLES_H} ${EXAMPLES_C}

default: Ex00_StartStop ${EXAMPLES}


Ex00_StartStop: Ex00_StartStop.o
	${CC} -o $@ $< ${CFLAGS} ${LDFLAGS}

%.c: %.jdf
	${DAGUEPP} -i $< -o `basename $@ .c` ${DAGUEPPFLAGS} -- ${CFLAGS}

%.o: %.c
	${CC} -o $@ -c $< ${CFLAGS}

Ex01_HelloWorld: Ex01_HelloWorld.o
	${CC} -o $@ $< ${CFLAGS} ${LDFLAGS}

clean:
	rm -f *.o

cleanall: clean
	rm -f ${EXAMPLES} ${EXAMPLES_C} ${EXAMPLES_H}
